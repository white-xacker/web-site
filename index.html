<!DOCTYPE html>
<html>
<head>
    <title>Yuklanmoqda...</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <script>
        const supabaseUrl = "Sizning_URL";
        const supabaseKey = "Sizning_Key";
        const supabase = Supabase.createClient(supabaseUrl, supabaseKey);

        async function router() {
            const params = new URLSearchParams(window.location.search);
            const id = params.get('id');

            if (!id) {
                document.body.innerHTML = "<h1>QR kod xato yoki ID topilmadi!</h1>";
                return;
            }

            // Bazadan tekshiramiz
            const { data, error } = await supabase
                .from('users')
                .select('id')
                .eq('id', id)
                .single();

            if (data) {
                // Karta band bo'lsa
                window.location.href = `profile.html?id=${id}`;
            } else {
                // Karta bo'sh bo'lsa
                window.location.href = `register.html?id=${id}`;
            }
        }
        router();
    </script>
</body>
</html>