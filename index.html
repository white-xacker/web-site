<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <title>Yuklanmoqda...</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body style="background:#000; color:#fff; display:flex; justify-content:center; align-items:center; height:100vh; font-family:sans-serif;">
    <div id="msg">Tekshirilmoqda...</div>

    <script>
        const SB_URL = "https://vakuoatitkvxgkkyhzyi.supabase.co";
        const SB_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZha3VvYXRpdGt2eGdra3loenlpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA3OTY3MjgsImV4cCI6MjA4NjM3MjcyOH0.-gERCw7PtwYZLM78SMs7_OLM5tLkaM8qVpmmQ_joMEo";
        const _supabase = supabase.createClient(SB_URL, SB_KEY);

        async function check() {
            const id = new URLSearchParams(window.location.search).get('id');
            if (!id) { document.getElementById('msg').innerText = "ID topilmadi!"; return; }

            // .maybeSingle() - foydalanuvchi bo'lmasa xato bermaydi, null qaytaradi
            const { data, error } = await _supabase
                .from('users')
                .select('name')
                .eq('id', id)
                .maybeSingle();

            if (data && data.name) {
                window.location.replace("profile.html?id=" + id);
            } else {
                window.location.replace("register.html?id=" + id);
            }
        }
        check();
    </script>
</body>
</html>