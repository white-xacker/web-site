<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional Digital Card</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        :root {
            --neon-blue: #00d2ff;
            --deep-glass: rgba(255, 255, 255, 0.07);
            --border-white: rgba(255, 255, 255, 0.15);
        }

        body {
            background: #050505;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(0, 210, 255, 0.05) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(58, 123, 213, 0.05) 0%, transparent 20%);
            color: white;
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
        }

        .profile-container {
            width: 100%;
            max-width: 380px;
            padding: 15px;
        }

        .glass-card {
            background: var(--deep-glass);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--border-white);
            border-radius: 40px;
            padding: 45px 25px;
            text-align: center;
            box-shadow: 0 40px 100px rgba(0, 0, 0, 0.8);
        }

        /* Kattaroq va Har qanday rasmga moslashadigan Profil rasm */
        .avatar-wrapper {
            position: relative;
            width: 180px; /* Kattalashtirildi */
            height: 180px;
            margin: 0 auto 25px;
        }

        .user-img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover; /* Rasmni markazlab kesadi, chetlarini oqartirmaydi */
            border: 4px solid var(--neon-blue);
            box-shadow: 0 0 30px rgba(0, 210, 255, 0.2);
        }

        .online-dot {
            position: absolute;
            bottom: 12px;
            right: 12px;
            width: 22px;
            height: 22px;
            background: #00ff88;
            border-radius: 50%;
            border: 4px solid #111;
        }

        h2 {
            font-size: 30px;
            margin: 10px 0;
            font-weight: 800;
            letter-spacing: -0.5px;
        }

        .digital-id {
            color: var(--neon-blue);
            font-size: 13px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 3px;
            margin-bottom: 35px;
            opacity: 0.8;
        }

        .info-stack {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        /* Ikonkalar bilan ma'lumot qismi */
        .info-row {
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid rgba(255, 255, 255, 0.05);
            padding: 18px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            text-decoration: none;
            color: white;
            transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .info-row:hover {
            background: rgba(0, 210, 255, 0.1);
            transform: scale(1.02);
            border-color: var(--neon-blue);
        }

        .icon-box {
            width: 45px;
            height: 45px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 20px;
            color: var(--neon-blue);
        }

        .details {
            text-align: left;
        }

        .details label {
            display: block;
            font-size: 11px;
            color: #777;
            text-transform: uppercase;
            margin-bottom: 2px;
        }

        .details span {
            font-size: 16px;
            font-weight: 500;
        }

        /* Yuklanish holati */
        #loader {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            font-size: 24px;
            color: var(--neon-blue);
        }

    </style>
</head>
<body>

<div class="profile-container" id="profile-container">
    <div id="loader"><i class="fas fa-spinner fa-spin"></i></div>
</div>

<script>
    const SB_URL = "https://vakuoatitkvxgkkyhzyi.supabase.co";
    const SB_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZha3VvYXRpdGt2eGdra3loenlpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA3OTY3MjgsImV4cCI6MjA4NjM3MjcyOH0.-gERCw7PtwYZLM78SMs7_OLM5tLkaM8qVpmmQ_joMEo";
    const _supabase = supabase.createClient(SB_URL, SB_KEY);

    async function fetchUser() {
        const id = new URLSearchParams(window.location.search).get('id');
        if (!id) return;

        const { data, error } = await _supabase.from('users').select('*').eq('id', id).single();

        if (data) {
            document.getElementById('profile-container').innerHTML = `
                <div class="glass-card">
                    <div class="avatar-wrapper">
                        <img src="${data.image_url}" class="user-img" alt="User Image">
                        <div class="online-dot"></div>
                    </div>

                    <h2>${data.name}</h2>
                    <div class="digital-id">DIGITAL PASS #${data.id}</div>

                    <div class="info-stack">
                        <a href="tel:${data.phone}" class="info-row">
                            <div class="icon-box"><i class="fa-solid fa-phone-volume"></i></div>
                            <div class="details">
                                <label>Bog'lanish uchun</label>
                                <span>${data.phone}</span>
                            </div>
                        </a>

                        <a href="https://t.me/${data.telegram.replace('@','')}" class="info-row" target="_blank">
                            <div class="icon-box"><i class="fa-solid fa-comment-dots"></i></div>
                            <div class="details">
                                <label>Telegram Chat</label>
                                <span>@${data.telegram.replace('@','')}</span>
                            </div>
                        </a>

                        <div class="info-row">
                            <div class="icon-box"><i class="fa-solid fa-shield-check" style="color:#00ff88"></i></div>
                            <div class="details">
                                <label>Hisob holati</label>
                                <span style="color:#00ff88">Tasdiqlangan foydalanuvchi</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        } else {
            document.getElementById('profile-container').innerHTML = "<h2>Profil topilmadi</h2>";
        }
    }
    fetchUser();
</script>

</body>
</html>