<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profil</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        * { margin:0; padding:0; box-sizing:border-box; font-family: 'Poppins', sans-serif; }
        body { min-height:100vh; display:flex; justify-content:center; align-items:center; background: linear-gradient(135deg,#141E30,#243B55); padding: 20px; }
        .card { width:100%; max-width:380px; background: rgba(255,255,255,0.08); backdrop-filter: blur(20px); border-radius:30px; padding:25px; text-align:center; color:white; border: 1px solid rgba(255,255,255,0.1); }
        .image-box { width:100%; height:320px; overflow:hidden; border-radius:20px; margin-bottom:20px; border: 2px solid #00d2ff; }
        .image-box img { width:100%; height:100%; object-fit:cover; }
        h2 { font-size: 26px; margin-bottom: 20px; font-weight: 700; }
        .btn { display:flex; align-items:center; justify-content:center; gap:12px; text-decoration:none; color:white; padding:16px; margin:12px 0; border-radius:18px; font-weight:500; transition:0.3s; font-size: 16px; }
        .call { background: linear-gradient(45deg,#00b09b,#96c93d); }
        .sms { background: linear-gradient(45deg,#ff512f,#dd2476); }
        .telegram { background: linear-gradient(45deg,#0088cc,#005f8d); }
        .btn:hover { transform: translateY(-3px); box-shadow: 0 10px 20px rgba(0,0,0,0.4); }
    </style>
</head>
<body>
    <div id="content"></div>
    <script>
        const SB_URL = "https://vakuoatitkvxgkkyhzyi.supabase.co";
        const SB_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZha3VvYXRpdGt2eGdra3loenlpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA3OTY3MjgsImV4cCI6MjA4NjM3MjcyOH0.-gERCw7PtwYZLM78SMs7_OLM5tLkaM8qVpmmQ_joMEo";
        const _supabase = supabase.createClient(SB_URL, SB_KEY);

        async function loadProfile() {
            const id = new URLSearchParams(window.location.search).get('id');
            const { data } = await _supabase.from('users').select('*').eq('id', id).single();
            if (data) {
                document.getElementById('content').innerHTML = `
                    <div class="card">
                        <div class="image-box"><img src="${data.image_url}"></div>
                        <h2>${data.name}</h2>
                        <a href="tel:${data.phone}" class="btn call"><i class="fa-solid fa-phone"></i> Qo'ng'iroq qilish</a>
                        <a href="sms:${data.phone}" class="btn sms"><i class="fa-solid fa-comment-sms"></i> SMS yozish</a>
                        <a href="https://t.me/${data.telegram}" target="_blank" class="btn telegram"><i class="fa-brands fa-telegram"></i> Telegramdan yozish</a>
                    </div>`;
            } else {
                document.body.innerHTML = "<h2 style='color:white'>Foydalanuvchi topilmadi</h2>";
            }
        }
        loadProfile();
    </script>
</body>
</html>